---
title: "FFI Database Summary"
subtitle: "Northeast Region"
output: 
  html_document:
    theme: readable
    highlight: 
    toc: yes
    toc_depth: 3
    toc_float:
      smooth_scroll: yes
    code_download: true
  pdf_document:
    toc: yes
    toc_depth: 3
---

# Purpose 

This report summarizes plot work by the NPS Fire Ecology Program. The included graphs allow a user to quickly view the overall status of program, park, project, or protocol activities in an FFI admin unit.

The code summarizes records in the Macroplot Report and Sample Event Report that can be downloaded via the Utilities menu on the Project Management tab on the FFI Remote App Server. You can recreate this Metadata Report by running code found in the file "QAQC_MetadataReport.R", under the scripts folder for this R project.

#### Setup

```{r}
## Markdown Options
knitr::opts_chunk$set(echo = FALSE, error = FALSE, warning = FALSE, message = FALSE)
```

```{r}
## Install packages (if needed)

# install.packages("tidyverse")
# install.packages("kableExtra")
# install.packages("ggplot2")
```

```{r}
## Load Packages

# "here" helps you easily find and reference your working directory
library(here)
# "tidyverse" has lots of useful functions for data cleaning
library(tidyverse)
# "kableExtra" is used to produce formatted tables
library(kableExtra)
library(ggplot2)
library(RColorBrewer)
library(grDevices)
```

```{r}
## Adjust File Paths

# Identify working directory
here()

# Adjust File Paths
path_data <- "E:/Allie/FireFX_NER/FFI Data Management/Exports/"
#path_data <- "C:/Users/alalor/OneDrive - DOI/NER/FireFX/FFI Data Management/Exports/"
path_graphs <- paste0(here(), "/output/graphs/")
```

#### Load Data

Load in the Metadata Report. This Metadata Report was created by combining Macroplot Reports and Sample Event Reports from each Admin Unit, which can be downloaded via the Utilities menu on the Project Management tab on the FFI Remote App Server.

```{r}
# Load in data
MetadataReport_ANTI <- read.csv(paste0(path_data, "ANTI/ANTI_MetadataReport.csv"), quote = "")
MetadataReport_APCO <- read.csv(paste0(path_data, "APCO/APCO_MetadataReport.csv"), quote = "")
MetadataReport_CATO <- read.csv(paste0(path_data, "CATO/CATO_MetadataReport.csv"), quote = "")
MetadataReport_CUVA <- read.csv(paste0(path_data, "CUVA/CUVA_MetadataReport.csv"), quote = "")
MetadataReport_DEWA <- read.csv(paste0(path_data, "DEWA/DEWA_MetadataReport.csv"), quote = "")
MetadataReport_FRSP <- read.csv(paste0(path_data, "FRSP/FRSP_MetadataReport.csv"), quote = "")
MetadataReport_GATE <- read.csv(paste0(path_data, "GATE/GATE_MetadataReport.csv"), quote = "")
MetadataReport_GETT <- read.csv(paste0(path_data, "GETT/GETT_MetadataReport.csv"), quote = "")
MetadataReport_MONO <- read.csv(paste0(path_data, "MONO/MONO_MetadataReport.csv"), quote = "")
MetadataReport_NERI <- read.csv(paste0(path_data, "NERI/NERI_MetadataReport.csv"), quote = "")
MetadataReport_PRWI <- read.csv(paste0(path_data, "PRWI/PRWI_MetadataReport.csv"), quote = "")
MetadataReport_RICH <- read.csv(paste0(path_data, "RICH/RICH_MetadataReport.csv"), quote = "")
MetadataReport_SARA <- read.csv(paste0(path_data, "SARA/SARA_MetadataReport.csv"), quote = "")
MetadataReport_SHEN <- read.csv(paste0(path_data, "SHEN/SHEN_MetadataReport.csv"), quote = "")
MetadataReport_VAFO <- read.csv(paste0(path_data, "VAFO/VAFO_MetadataReport.csv"), quote = "")
```

#### Merge Data

```{r}
MetadataReport <- rbind(MetadataReport_ANTI, MetadataReport_APCO, MetadataReport_CATO, MetadataReport_CUVA, MetadataReport_DEWA, MetadataReport_FRSP, MetadataReport_GATE, MetadataReport_GETT, MetadataReport_MONO, MetadataReport_NERI, MetadataReport_PRWI, MetadataReport_RICH, MetadataReport_SARA, MetadataReport_SHEN, MetadataReport_VAFO)

remove(MetadataReport_ANTI, MetadataReport_APCO, MetadataReport_CATO, MetadataReport_CUVA, MetadataReport_DEWA, MetadataReport_FRSP, MetadataReport_GATE, MetadataReport_GETT, MetadataReport_MONO, MetadataReport_NERI, MetadataReport_PRWI, MetadataReport_RICH, MetadataReport_SARA, MetadataReport_SHEN, MetadataReport_VAFO)
```

#### Add Columns

#### Region

-   Region (NER)

-   Zone (e.g. South)

-   Unit (e.g. MTTS)

```{r}
zone_NewEngland <- c("ACAD", "CACO")
zone_MidAtlantic <- c("DEWA", "GATE", "GETT", "SARA", "VAFO")
zone_NCA <- c("ANTI", "CATO", "MONO", "PRWI")
zone_Allegheny <- c("CUVA", "NERI")
zone_MTTS <- c("APCO", "FRSP", "RICH", "SHEN")

MetadataReport <- MetadataReport %>% 
  mutate(Region = ifelse(AdministrationUnit_Name %in% c(zone_NCA), "NCR", "NER")) %>% 
  mutate(Zone = ifelse(AdministrationUnit_Name %in% c(zone_NewEngland, zone_MidAtlantic), "North",
                       ifelse(AdministrationUnit_Name %in% c(zone_Allegheny, zone_MTTS), "South", "NCA"))) %>% 
  mutate(Unit = ifelse(AdministrationUnit_Name %in% zone_NewEngland, "NewEngland",
                       ifelse(AdministrationUnit_Name %in% zone_MidAtlantic, "MidAtlantic", 
                              ifelse(AdministrationUnit_Name %in% zone_Allegheny, "Allegheny",
                                    ifelse(AdministrationUnit_Name %in% zone_MTTS, "MTTS", "NCA"))))) %>%
  relocate(Region, .before = AdministrationUnit_Name) %>% 
  relocate(Zone, .before = AdministrationUnit_Name) %>%
  relocate(Unit, .before = AdministrationUnit_Name)
```

#### Macroplot

-   Macroplot_Num (01, 02...)

-   Purpose or PlotType (FMH, RAP...)

-   DateIn_Year

-   SampleEventDate_Year

```{r}
MetadataReport <- MetadataReport %>% 
  extract(Macroplot, regex = "([0-9]+)", into = c("Macroplot_Num"), remove = F) %>% 
  separate(Macroplot, sep = "(?=[0-9])", into = c("Macroplot_Code"), remove = F) %>%
  mutate(Macroplot_Num = ifelse(is.na(Macroplot_Num), 0, Macroplot_Num)) %>% 
  mutate(Macroplot_Num = as.numeric(Macroplot_Num))
```

#### Split MetadataReport

```{r}
MetadataReport_Disturbances <- MetadataReport %>% 
  filter(MonStatus %in% c("", "Burn", "Herbicide", "Mechanical", "Mow")) %>%  
  mutate(DisturbanceDate = SampleEventDate) %>% 
  mutate(DisturbanceDate_Year = SampleEventDate_Year)

MetadataReport_Reads <- MetadataReport %>% 
  filter(!MonStatus %in% c("", "Burn", "Herbicide", "Mechanical", "Mow")) %>% 
  mutate(DisturbanceDate = NA) %>% 
  mutate(DisturbanceDate_Year = NA)
```

#### MonStatus

-   Entry / Prefix (0, 1, 2, 3 , 4...)

-   Status (pre, post)

-   TimeSince / Suffix (0, 1, 2, 5, 10, 20)

```{r}
MonStatus <- MetadataReport_Reads %>% 
  select(MonStatus) %>% 
  filter(!is.na(MonStatus))
MonStatus <- unique(MonStatus)

# Create column with consistent naming
MonStatus <- MonStatus %>%
  mutate(MonStatus_new = ifelse(MonStatus %in%  c("Pre", "PRE", "Preyr00", "Measure", "2001Density", "2001Measure", "2002Density", "2002Measure", "2003Density", "2003Measure", "2004Measure"), "00 Pre", 
                                ifelse(MonStatus %in% c("Pre 2", "Pre 02"), "00 PR1",
                                       ifelse(MonStatus %in% c("Pre 3"), "00 PR2",
                                              ifelse(MonStatus %in% c("Pre 4"), "00 PR3",
                                                     ifelse(MonStatus %in% c("Pre 5"), "00 PR4",
                                                            ifelse(MonStatus %in% c("01Post"), "01 Post 00",
                                                                   ifelse(MonStatus %in% c("01yr01"), "01 Yr 01",
                                                                          ifelse(MonStatus %in% c("01Yr02"), "01 Yr 02",
                                                                                 ifelse(MonStatus %in% c("01Yr03"), "01 Yr 03",
                                                                                        ifelse(MonStatus %in% c("00 Post (Initial CBI)", "01 Post (Extended CBI)", "01 Post (Initial CBI)", "Severity"), "01 Post 00", MonStatus)))))))))))

#order <- seq(1, nrow(MonStatus))

# Extract info
MonStatus <- MonStatus %>%
  arrange(MonStatus_new) %>%
  mutate(MonStatusOrd = row_number()) %>%
  separate(MonStatus_new, sep = " ", into = c("Entry","Status","TimeSince"), remove = F) %>%
  # fix up classifications
  mutate(Status = ifelse(Status %in% c("Yr", "yr"), "Post", Status)) %>%
  mutate(Status = ifelse(Status %in%  c("PR1", "PR2", "PR3", "PR4"), "Pre", Status)) %>%
  # make columns numeric
  mutate(Entry = as.numeric(Entry),
         TimeSince = as.numeric(TimeSince)) %>% 
  select(!MonStatus_new)
```

#### Disturbance

-   Disturbance_Type (Burn, Herbicide, Mechanical, Mow)

-   Disturbance_Year (actual year)

```{r}
Disturbances <- MetadataReport_Disturbances %>% 
  filter(MonStatus == "Burn") %>% 
  arrange(AdministrationUnit_Name, Macroplot, SampleEventDate) %>% 
  group_by(AdministrationUnit_Name, Macroplot) %>% 
  mutate(Entry = row_number(),
         Status = "Post",
         TimeSince = 0,
         MonStatusOrd = NA)
```

#### Merge

```{r}
# Disturbance
MetadataReport_Disturbances <- merge(MetadataReport_Disturbances, Disturbances, all = T)

# Mon Status
MetadataReport_Reads <- merge(MetadataReport_Reads, MonStatus, by = c("MonStatus"), all = T)

# Merge all
MetadataReport_all <- rbind(MetadataReport_Disturbances, MetadataReport_Reads) %>% 
  arrange(AdministrationUnit_Name, Macroplot, SampleEventDate)
```

#### Other

-   Disturbance_Entry (to match with MonStatus)

-   Disturbance_Desc (RX, WF-SUPP, WFU, WF)

-   Disturbance_Name (e.g. Cape Final)

-   Disturbance_Severity (Unaltered, Low, Low/Moderate, Moderate, Moderate/High, High)

-   FuelType (PIPO, PIED, etc.)

# Graphs

```{r}
MetadataReport_all <- MetadataReport_all %>% 
  # remove unnecessary columns
  # select(!c(Latitude, Longitude, UTM_X, UTM_Y, UTM_Zone, Datum, PDOP, Precision, )) %>% 
  # select(!c(Elevation, ElevationUnits, Azimuth, Aspect, SlopeHill, SlopeTransect)) %>% 
  # select(!c(LocatedBy, FutureVisit, DateOut, StartPoint, Directions, Comments, SampleEventTeam, SampleEventComment, LegacyMonStatus)) %>% 
  mutate(AdministrationUnit_Name = factor(AdministrationUnit_Name),
         Type = factor(Type),
         ProjectUnit = factor(ProjectUnit),
         Purpose = factor(Purpose),
         Macroplot = factor(Macroplot),
         Protocols = factor(Protocols),
         Visited = factor(Visited),
         MonStatus = factor(MonStatus),
         DateIn = as.Date(DateIn),
         DateIn_Year = as.numeric(DateIn_Year),
         SampleEventDate = as.Date(SampleEventDate),
         SampleEventDate_Year = as.numeric(SampleEventDate_Year),
         DisturbanceDate = as.Date(DisturbanceDate),
         DisturbanceDate_Year = as.numeric(DisturbanceDate_Year),
         Entry = as.numeric(Entry),
         Macroplot_Num = as.factor(Macroplot_Num)) %>% 
    mutate(Purpose_Code = ifelse(Purpose == "Fire Monitoring Handbook", "FMH",
                            ifelse(Purpose == "Inventory & Monitoring", "I&M",
                                   ifelse(Purpose == "Composite Burn Index", "CBI",
                                          ifelse(Purpose=="Rapid Assessment","RA",
                                                 ifelse(Purpose=="Fuels","Fuels",
                                                        "FMH")))))) %>% 
  relocate(Purpose_Code, .after = Purpose)
```

## Zone Summary

```{r}
MetadataReport_all %>% 
  ggplot(aes(x = SampleEventDate_Year, y = Macroplot_Num, color = Entry)) +
  geom_line(aes(group = Macroplot), color = "red") +
  geom_point(size = 2) +
  geom_line(aes(group = Macroplot)) +
  geom_point(color = "red", shape = 1, size = 2) +
  facet_grid(Purpose_Code ~ AdministrationUnit_Name) +
  labs(title = paste0("Sample Event History"),
       subtitle = "All Plots",
       y = "Plot Number",
       x = "Year",
       color = "Entry") +
  # scale_color_manual(values=c('forestgreen',"yellowgreen","lightgreen","lightyellow", "yellow", "orange", 'darkorange', "red","red3", "darkred","darkgrey", "black")) +
  theme_light() +
  scale_x_continuous(breaks = seq(1995, 2030, by = 1)) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        plot.title = element_text(size = 20, face="bold", hjust = 0.5),
        plot.subtitle = element_text(size = 12, face="italic", hjust = 0.5),
        axis.title = element_text(size = 12, face="bold"),
        axis.title.y = element_text(margin = unit(c(0,4,0,0), "mm")),
        axis.title.x = element_text(margin = unit(c(4,0,0,0), "mm")),
        axis.text.y = element_text(size = 5),
        axis.text.x = element_text(size = 5, angle = 90, vjust = 0.5, hjust=1),
        legend.position = "none")

#ggsave(path = path_graphs, filename = "Sample Event History_All WACA.jpg", width = 8, height = 6, unit = "in", dpi = 300)
```

### South Zone

```{r}
MetadataReport_all %>% 
  filter(Purpose == "Fire Monitoring Handbook",
         Zone == "South") %>%
  ggplot(aes(x = SampleEventDate_Year, y = Macroplot_Num, color = Entry)) +
  geom_line(aes(group = Macroplot), color = "red") +
  geom_point(size = 2) +
  geom_line(aes(group = Macroplot)) +
  geom_point(color = "red", shape = 1, size = 2) +
  facet_grid(Type ~ AdministrationUnit_Name) +
  labs(title = paste0("Sample Event History"),
       subtitle = "Fire Monitoring Handbook (FMH) Plots",
       y = "Plot Number",
       x = "Year",
       color = "Entry") +
  # scale_color_manual(values=c('forestgreen',"yellowgreen","lightgreen","lightyellow", "yellow", "orange", 'darkorange', "red","red3", "darkred","darkgrey", "black")) +
  theme_light() +
  scale_x_continuous(breaks = seq(1995, 2030, by = 1)) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        plot.title = element_text(size = 20, face="bold", hjust = 0.5),
        plot.subtitle = element_text(size = 12, face="italic", hjust = 0.5),
        axis.title = element_text(size = 12, face="bold"),
        axis.title.y = element_text(margin = unit(c(0,4,0,0), "mm")),
        axis.title.x = element_text(margin = unit(c(4,0,0,0), "mm")),
        axis.text.y = element_text(size = 5),
        axis.text.x = element_text(size = 5, angle = 90, vjust = 0.5, hjust=1),
        legend.position = "none")

#ggsave(path = path_graphs, filename = "Sample Event History_All WACA.jpg", width = 8, height = 6, unit = "in", dpi = 300)
```

### North Zone

```{r}
MetadataReport_all %>% 
  filter(Purpose == "Fire Monitoring Handbook",
         Zone == "North") %>%
  ggplot(aes(x = SampleEventDate_Year, y = Macroplot_Num, color = Entry)) +
  geom_line(aes(group = Macroplot), color = "red") +
  geom_point(size = 2) +
  geom_line(aes(group = Macroplot)) +
  geom_point(color = "red", shape = 1, size = 2) +
  facet_grid(Type ~ AdministrationUnit_Name) +
  labs(title = paste0("Sample Event History"),
       subtitle = "Fire Monitoring Handbook (FMH) Plots",
       y = "Plot Number",
       x = "Year",
       color = "Entry") +
  # scale_color_manual(values=c('forestgreen',"yellowgreen","lightgreen","lightyellow", "yellow", "orange", 'darkorange', "red","red3", "darkred","darkgrey", "black")) +
  theme_light() +
  scale_x_continuous(breaks = seq(1985, 2030, by = 1)) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        plot.title = element_text(size = 20, face="bold", hjust = 0.5),
        plot.subtitle = element_text(size = 12, face="italic", hjust = 0.5),
        axis.title = element_text(size = 12, face="bold"),
        axis.title.y = element_text(margin = unit(c(0,4,0,0), "mm")),
        axis.title.x = element_text(margin = unit(c(4,0,0,0), "mm")),
        axis.text.y = element_text(size = 5),
        axis.text.x = element_text(size = 5, angle = 90, vjust = 0.5, hjust=1),
        legend.position = "none")

#ggsave(path = path_graphs, filename = "Sample Event History_All WACA.jpg", width = 8, height = 6, unit = "in", dpi = 300)
```

### National Capital Area

```{r}
MetadataReport_all %>% 
  filter(Purpose == "Fire Monitoring Handbook",
         Zone == "NCA") %>%
  ggplot(aes(x = SampleEventDate_Year, y = Macroplot_Num, color = Entry)) +
  geom_line(aes(group = Macroplot), color = "red") +
  geom_point(size = 2) +
  geom_line(aes(group = Macroplot)) +
  geom_point(color = "red", shape = 1, size = 2) +
  facet_grid(Type ~ AdministrationUnit_Name) +
  labs(title = paste0("Sample Event History"),
       subtitle = "Fire Monitoring Handbook (FMH) Plots",
       y = "Plot Number",
       x = "Year",
       color = "Entry") +
  # scale_color_manual(values=c('forestgreen',"yellowgreen","lightgreen","lightyellow", "yellow", "orange", 'darkorange', "red","red3", "darkred","darkgrey", "black")) +
  theme_light() +
  scale_x_continuous(breaks = seq(1995, 2030, by = 1)) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        plot.title = element_text(size = 20, face="bold", hjust = 0.5),
        plot.subtitle = element_text(size = 12, face="italic", hjust = 0.5),
        axis.title = element_text(size = 12, face="bold"),
        axis.title.y = element_text(margin = unit(c(0,4,0,0), "mm")),
        axis.title.x = element_text(margin = unit(c(4,0,0,0), "mm")),
        axis.text.y = element_text(size = 5),
        axis.text.x = element_text(size = 5, angle = 90, vjust = 0.5, hjust=1),
        legend.position = "none")

#ggsave(path = path_graphs, filename = "Sample Event History_All WACA.jpg", width = 8, height = 6, unit = "in", dpi = 300)
```

## Park Summary

```{r}
#unique(MetadataReport_all$AdministrationUnit_Name)
target_purpose <- "Fire Monitoring Handbook"
target_park <- "RICH"
target_type <- "Grassland"
```

```{r}
graph_MetadataReport <- MetadataReport_all %>% 
  filter(Purpose %in% target_purpose,
         AdministrationUnit_Name %in% target_park,
         Type %in% target_type)

graph_Disturbances <- graph_MetadataReport %>% 
  filter(MonStatus %in% c("Burn", "Herbicide", "Mechanical", "Mow"))

graph_sum_Disturbances <- graph_Disturbances %>%
  group_by(Region, Zone, Unit, AdministrationUnit_Name, Type, DisturbanceDate, DisturbanceDate_Year, SampleEventDate_Year, MonStatus) %>%
  filter(DisturbanceDate_Year == SampleEventDate_Year) %>%
  summarize(n_Macroplot = n()) %>%
  mutate(DisturbanceDate = as.Date(DisturbanceDate),
         Macroplot_Num = "All") %>% 
  arrange(desc(MonStatus))
```

Selected purpose: [`r target_purpose`]{style="color:red"}\
Selected park: [`r target_park`]{style="color:red"}\
Selected type: [`r target_type`]{style="color:red"}

### Disturbance History 

```{r}
graph_MetadataReport %>% 
  ggplot(aes(x = DisturbanceDate, y = Macroplot_Num)) +
  # geom_line(aes(group = Macroplot_Num, color = Entry)) +
  # geom_point(aes(color = Entry), size = 2) +
  geom_line(aes(group = Macroplot_Num),
            data = graph_sum_Disturbances) +
  geom_point(aes(X = DisturbanceDate, y = Macroplot_Num, fill = MonStatus),
             data = graph_sum_Disturbances, shape = 21) +
  geom_line(aes(X = DisturbanceDate, y = Macroplot_Num, fill = MonStatus),
            data = graph_sum_Disturbances) +
  geom_point(aes(X = DisturbanceDate, y = Macroplot_Num, fill = MonStatus),
             data = graph_sum_Disturbances, shape = 21, size = 2.5) +
  facet_grid(Type ~ AdministrationUnit_Name) +
  labs(title = "Disturbance History",
       y = "",
       x = "Year",
       fill = "") +
  scale_x_date(limits = c(min(graph_MetadataReport$SampleEventDate), Sys.Date()), 
               date_labels = "%Y", date_breaks = "1 year") +
  theme_light() +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        plot.title = element_text(size = 20, face="bold", hjust = 0.5),
        axis.title = element_text(size = 12, face="bold"),
        axis.title.y = element_text(margin = unit(c(0,4,0,0), "mm")),
        axis.title.x = element_text(margin = unit(c(4,0,0,0), "mm")),
        axis.text.y = element_text(size = 8),
        axis.text.x = element_text(size = 8, angle = 90, vjust = 0.5, hjust=1),
        legend.position = "top")
```

### Sample Event History

```{r}
graph_MetadataReport %>% 
  ggplot(aes(x = SampleEventDate_Year, y = Macroplot_Num)) +
  geom_line(aes(group = Macroplot_Num, color = Entry)) +
  geom_point(aes(color = Entry), size = 2) +
  geom_line(aes(group = Macroplot_Num),
            data = graph_sum_Disturbances) +
  geom_point(aes(X = DisturbanceDate, y = Macroplot_Num, fill = MonStatus),
             data = graph_sum_Disturbances, shape = 21) +
  geom_point(aes(X = DisturbanceDate, y = Macroplot_Num, fill = MonStatus),
             data = graph_MetadataReport %>% 
                      filter(MonStatus == "Burn"), 
             shape = 3, size = 5, color = "darkred") +
  facet_grid(Type ~ AdministrationUnit_Name) +
  labs(title = paste0("Sample Event History"),
       subtitle = "Fire Monitoring Handbook (FMH) Plots",
       y = "Plot Number",
       x = "Year",
       color = "Entry",
       fill = "Disturbance Type") +
  # scale_color_manual(values=c('forestgreen',"lightgreen","lightyellow", "yellow", "orange", 'darkorange', "orange4", "red","red3", "darkred", "coral4", "black")) +
  # scale_fill_gradient(low = "green", high = "red") +
  theme_light() +
  scale_x_continuous(breaks = seq(1995, 2030, by = 1)) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        plot.title = element_text(size = 20, face="bold", hjust = 0.5),
        plot.subtitle = element_text(size = 12, face="italic", hjust = 0.5),
        axis.title = element_text(size = 12, face="bold"),
        axis.title.y = element_text(margin = unit(c(0,4,0,0), "mm")),
        axis.title.x = element_text(margin = unit(c(4,0,0,0), "mm")),
        axis.text.y = element_text(size = 5),
        axis.text.x = element_text(size = 5, angle = 90, vjust = 0.5, hjust=1),
        legend.position = "none")
```
