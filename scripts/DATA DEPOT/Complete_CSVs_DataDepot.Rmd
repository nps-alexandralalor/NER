---
title: Complete CSVs
author: Alexandra Lalor
output:
  html_document:
    theme: readable
    highlight: null
    toc: true
    toc_depth: 1
    toc_float:
      smooth_scroll: true
    code_download: true
  word_document:
    toc: true
    toc_depth: 1
  pdf_document:
    toc: true
    toc_depth: 1
---

# PURPOSE

This code is intended to quality check [all FFI CSV exports]{.underline} for fundamental errors. If these errors are not addressed first, subsequent R scripts may not run properly.

### Export all CSVs from Data Depot

-   English_ffi_PARK_data_export\_#############.zip

-   Metric_ffi_PARK_data_export\_#############.zip

Populated Data includes:

-   ffi_PARK_data_export_project_units.csv

-   ffi_PARK_data_export_cover_points.csv

-   ffi_PARK_data_export_cover_species_composition.csv

-   ffi_PARK_data_export_surface_fuels_duff_litter.csv

-   ffi_PARK_data_export_surface_fuels_fine.csv

-   ffi_PARK_data_export_surface_fuels_thousand_hr.csv

-   ffi_PARK_data_export_trees_individuals.csv

Excess Data includes:

-   ffi_PARK_data_export_cover_frequency.csv

-   ffi_PARK_data_export_surface_fuels_alaska_duff_litter.csv

-   ffi_PARK_data_export_surface_fuels_piles.csv

-   ffi_PARK_data_export_surface_fuels_vegetation.csv

-   ffi_PARK_data_export_trees_saplings.csv

-   ffi_PARK_data_export_trees_seedlings.csv

Missing Protocols

-   Post Burn Severity (metric)\_XPT.csv

-   Density - Quadrats (metric)\_XPT.csv

-   Density - Belts (metric)\_XPT.csv

### Major issues to check across all CSVs

-   Check that column names match expected

-   Check that number of rows match expected

-   Check that data matches expected (especially conversions between metric and english

## Before Starting {.hidden}

### Setup {.hidden}

```{r setup, include=FALSE}
## Markdown Options
knitr::opts_chunk$set(echo = FALSE, error = FALSE, warning = FALSE, message = FALSE)
```

```{r install packages, include=FALSE}
## Install packages (if needed)

# install.packages("tidyverse")
# install.packages("janitor")
# install.packages("condformat")
# install.packages("knitr")
# install.packages("here")
# install.packages("diffdf")
```

```{r load packages, include=FALSE}
## Load Packages

# tidyverse and dplyr have lots of useful functions for data cleaning
library(tidyverse)
library(dplyr)
# diffdf will find differences between databases
library(diffdf)
```

### Target Park {.hidden}

```{r}
# designate target park(s)
target_park <- "CATO"
```

### Adjust File Paths {.hidden}

```{r import data, include=FALSE}
# adjust file paths
#path_main <- "E:/Allie/FireFX_NER/FFI Data Management/"
path_main <- "C:/Users/alalor/OneDrive - DOI/NER/FireFX/FFI Data Management/"
path_file <- paste0(path_main, "Exports Data Depot/", target_park, "/")
path_data_english <- paste0(path_file, "English_ffi_", target_park, "_data_export/")
path_data_metric <- paste0(path_file, "Metric_ffi_", target_park, "_data_export/")
path_data_original <- paste0(path_main, "R Outputs Data Depot/", target_park, "/", target_park, "_")
```

### Zip Data {.hidden}

### Load Data {.hidden}

```{r}
# load data

# # project unit report
# ProjectUnitReport_E <- read_csv(paste0(path_data_english, "ffi_", target_park, "_data_export_project_units.csv"))
# ProjectUnitReport_M <- read_csv(paste0(path_data_metric, "ffi_", target_park, "_data_export_project_units.csv"))

# protocols
Fuels1000_O <- read_csv(paste0(path_data_original, "Data_Surface Fuels - 1000Hr.csv"))
FuelsDuffLitt_O <- read_csv(paste0(path_data_original, "Data_Surface Fuels - Duff_Litter.csv"))
FuelsFine_O <- read_csv(paste0(path_data_original, "Data_Surface Fuels - Fine.csv"))
Trees_O <- read_csv(paste0(path_data_original, "Data_Trees - Individuals (metric).csv"))
HerbsSpComp_O <- read_csv(paste0(path_data_original, "Data_Cover - Species Composition (metric).csv"))
HerbsPoints_O <- read_csv(paste0(path_data_original, "Data_Cover - Points (metric).csv"))
# protocols
Fuels1000_E <- read_csv(paste0(path_data_english, "ffi_", target_park, "_data_export_surface_fuels_thousand_hr.csv"))
FuelsDuffLitt_E <- read_csv(paste0(path_data_english, "ffi_", target_park, "_data_export_surface_fuels_duff_litter.csv"))
FuelsFine_E <- read_csv(paste0(path_data_english, "ffi_", target_park, "_data_export_surface_fuels_fine.csv"))
Trees_E <- read_csv(paste0(path_data_english, "ffi_", target_park, "_data_export_trees_individuals.csv"))
HerbsSpComp_E <- read_csv(paste0(path_data_english, "ffi_", target_park, "_data_export_cover_species_composition.csv"))
HerbsPoints_E <- read_csv(paste0(path_data_english, "ffi_", target_park, "_data_export_cover_points.csv"))
# protocols
Fuels1000_M <- read_csv(paste0(path_data_metric, "ffi_", target_park, "_data_export_surface_fuels_thousand_hr.csv"))
FuelsDuffLitt_M <- read_csv(paste0(path_data_metric, "ffi_", target_park, "_data_export_surface_fuels_duff_litter.csv"))
FuelsFine_M <- read_csv(paste0(path_data_metric, "ffi_", target_park, "_data_export_surface_fuels_fine.csv"))
Trees_M <- read_csv(paste0(path_data_metric, "ffi_", target_park, "_data_export_trees_individuals.csv"))
HerbsSpComp_M <- read_csv(paste0(path_data_metric, "ffi_", target_park, "_data_export_cover_species_composition.csv"))
HerbsPoints_M <- read_csv(paste0(path_data_metric, "ffi_", target_park, "_data_export_cover_points.csv"))


# # blank protocols
# PostBurn_O <- read.csv(paste0(path_data_original, "Data_Post Burn Severity (metric).csv"))
# Seedlings_O <- read.csv(paste0(path_data_original, "Data_Density - Quadrats (metric).csv"))
# Shrubs_O <- read.csv(paste0(path_data_original, "Data_Density - Belts (metric).csv"))
# # blank protocols
# FuelsDuffLittAK_E <- read_csv(paste0(path_data_english, "ffi_", target_park, "_data_export_surface_fuels_alaska_duff_litter.csv"))
# FuelsPiles_E <- read_csv(paste0(path_data_english, "ffi_", target_park, "_data_export_surface_fuels_piles.csv"))
# FuelsVeg_E <- read_csv(paste0(path_data_english, "ffi_", target_park, "_data_export_surface_fuels_vegetation.csv"))
# TreesSaplings_E <- read_csv(paste0(path_data_english, "ffi_", target_park, "_data_export_trees_saplings.csv"))
# TreesSeedlings_E <- read_csv(paste0(path_data_english, "ffi_", target_park, "_data_export_trees_seedlings.csv"))
# HerbsFrequency_E <- read_csv(paste0(path_data_english, "ffi_", target_park, "_data_export_cover_frequency.csv"))
# # blank protocols
# FuelsDuffLittAK_M <- read_csv(paste0(path_data_metric, "ffi_", target_park, "_data_export_surface_fuels_alaska_duff_litter.csv"))
# FuelsPiles_M <- read_csv(paste0(path_data_metric, "ffi_", target_park, "_data_export_surface_fuels_piles.csv"))
# FuelsVeg_M <- read_csv(paste0(path_data_metric, "ffi_", target_park, "_data_export_surface_fuels_vegetation.csv"))
# TreesSaplings_M <- read_csv(paste0(path_data_metric, "ffi_", target_park, "_data_export_trees_saplings.csv"))
# TreesSeedlings_M <- read_csv(paste0(path_data_metric, "ffi_", target_park, "_data_export_trees_seedlings.csv"))
# HerbsFrequency_M <- read_csv(paste0(path_data_metric, "ffi_", target_park, "_data_export_cover_frequency.csv"))
```

```{r}
# remove(PostBurn_O, Seedlings_O, Shrubs_O,
#        FuelsDuffLittAK_E, FuelsDuffLittAK_M,
#        FuelsPiles_E, FuelsPiles_M,
#        FuelsVeg_E, FuelsVeg_M,
#        TreesSaplings_E, TreesSaplings_M,
#        TreesSeedlings_E, TreesSeedlings_M,
#        HerbsFrequency_E, HerbsFrequency_M)
```

# ROWS

## Fuels 1000Hr (CWD)

```{r}
Fuels1000_DataDepot <- Fuels1000_E %>% 
  mutate(SampleEvent_Date = as.Date(SampleEvent_Date, "%m/%d/%Y")) %>% 
  arrange(Macroplot_Name, SampleEvent_Date, MethodData_index) %>% 
  select(!c(MethodData_fieldTeam, MethodData_entryTeam))
Fuels1000_DataFFI <- Fuels1000_O %>% 
  mutate(SampleEvent_Date = as.Date(SampleEvent_Date, "%m/%d/%Y")) %>% 
  arrange(Macroplot_Name, SampleEvent_Date, MethodData_index) %>% 
  select(!c(MethodData_fieldTeam, MethodData_entryTeam))
```

```{r}
#diffdf(Fuels1000_DataDepot, Fuels1000_DataFFI)
```

```{r}
Fuels1000_DataDepot <- Fuels1000_DataDepot %>% 
  select(!c("OrganizationId","AdminUnitId","MacroplotId","SampleEventId","MethodId","Organization_Name","AdminUnit_Comment","Macroplot_LocatedBy","Macroplot_DdLat","Macroplot_DdLong","Macroplot_UtmX (m)","Macroplot_UtmY (m)","Macroplot_UtmZone","Macroplot_Datum","Macroplot_Pdop","Macroplot_Precision","Macroplot_DateIn","Macroplot_FutureVisit","Macroplot_DateOut","Macroplot_Elevation","Macroplot_ElevationUnits","Macroplot_Azimuth","Macroplot_Aspect","Macroplot_SlopeHill (%)","Macroplot_SlopeTransect (%)","Macroplot_StartPoint","Macroplot_Directions","Macroplot_Comment","Macroplot_Metadata","SampleEvent_Who","SampleEvent_Comment","SampleEvent_UserVariables","SampleEvent_DefaultMonitoringStatus","SampleData_Executed","SampleData_SampleData","sampleEventId","MacroPlotId","MethodDataId","MethodData_id","MethodData_createdDate","MethodData_updatedDate","MethodData_deletedDate")) %>%
  select(!c(Macroplot_Purpose,Macroplot_Type,Macroplot_UV1,Macroplot_UV2,Macroplot_UV3,Macroplot_UV4,Macroplot_UV5,Macroplot_UV6,Macroplot_UV7,Macroplot_UV8,SampleEvent_TreatmentUnit)) %>% 
  select(!c(Macroplot_Name))


Fuels1000_DataFFI <- Fuels1000_DataFFI %>% 
  select(!c("MonitoringStatus_Name","MonitoringStatus_Prefix","MonitoringStatus_Base","MonitoringStatus_Suffix","MonitoringStatus_Order")) %>% 
  select(!c(Macroplot_Purpose,Macroplot_Type,Macroplot_UV1,Macroplot_UV2,Macroplot_UV3,Macroplot_UV4,Macroplot_UV5,Macroplot_UV6,Macroplot_UV7,Macroplot_UV8,SampleEvent_TreatmentUnit)) %>% 
  select(!c(Macroplot_Name))
```

```{r}
diffdf(Fuels1000_DataDepot, Fuels1000_DataFFI)
```

## Fuels Duff Litter (DL)

```{r}
FuelsDuffLitt_DataDepot <- FuelsDuffLitt_E %>% 
  mutate(SampleEvent_Date = as.Date(SampleEvent_Date, "%m/%d/%Y")) %>% 
  arrange(Macroplot_Name, SampleEvent_Date, MethodData_index) %>% 
  select(!c(MethodData_fieldTeam, MethodData_entryTeam))
FuelsDuffLitt_DataFFI <- FuelsDuffLitt_O %>% 
  mutate(SampleEvent_Date = as.Date(SampleEvent_Date, "%m/%d/%Y")) %>% 
  arrange(Macroplot_Name, SampleEvent_Date, MethodData_index) %>% 
  select(!c(MethodData_fieldTeam, MethodData_entryTeam))
```

```{r}
#diffdf(FuelsDuffLitt_DataDepot, FuelsDuffLitt_DataFFI)
```

```{r}
FuelsDuffLitt_DataDepot <- FuelsDuffLitt_DataDepot %>% 
  select(!c("OrganizationId","AdminUnitId","MacroplotId","SampleEventId","MethodId","Organization_Name","AdminUnit_Comment","Macroplot_LocatedBy","Macroplot_DdLat","Macroplot_DdLong","Macroplot_UtmX","Macroplot_UtmY","Macroplot_UtmZone","Macroplot_Datum","Macroplot_Pdop","Macroplot_Precision","Macroplot_DateIn","Macroplot_FutureVisit","Macroplot_DateOut","Macroplot_Elevation","Macroplot_ElevationUnits","Macroplot_Azimuth","Macroplot_Aspect","Macroplot_SlopeHill","Macroplot_SlopeTransect","Macroplot_StartPoint","Macroplot_Directions","Macroplot_Comment","Macroplot_Metadata","SampleEvent_Who","SampleEvent_Comment","SampleEvent_UserVariables","SampleEvent_DefaultMonitoringStatus","SampleData_Executed","SampleData_SampleData","sampleEventId","MacroPlotId","MethodDataId","MethodData_id","MethodData_createdDate","MethodData_updatedDate","MethodData_deletedDate")) %>% 
  select(!c(Macroplot_Purpose,Macroplot_Type,Macroplot_UV1,Macroplot_UV2,Macroplot_UV3,Macroplot_UV4,Macroplot_UV5,Macroplot_UV6,Macroplot_UV7,Macroplot_UV8,SampleEvent_TreatmentUnit)) %>% 
  select(!c(Macroplot_Name))


FuelsDuffLitt_DataFFI <- FuelsDuffLitt_DataFFI %>% 
  select(!c("MonitoringStatus_Name","MonitoringStatus_Prefix","MonitoringStatus_Base","MonitoringStatus_Suffix","MonitoringStatus_Order")) %>% 
  select(!c(Macroplot_Purpose,Macroplot_Type,Macroplot_UV1,Macroplot_UV2,Macroplot_UV3,Macroplot_UV4,Macroplot_UV5,Macroplot_UV6,Macroplot_UV7,Macroplot_UV8,SampleEvent_TreatmentUnit)) %>% 
  select(!c(Macroplot_Name))
```

```{r}
diffdf(FuelsDuffLitt_DataDepot, FuelsDuffLitt_DataFFI)
```

## Fuels Fine (FWD)

```{r}
FuelsFine_DataDepot <- FuelsFine_E %>% 
  mutate(SampleEvent_Date = as.Date(SampleEvent_Date, "%m/%d/%Y")) %>% 
  arrange(Macroplot_Name, SampleEvent_Date, MethodData_index) %>% 
  select(!c(MethodData_fieldTeam, MethodData_entryTeam))
FuelsFine_DataFFI <- FuelsFine_O %>% 
  mutate(SampleEvent_Date = as.Date(SampleEvent_Date, "%m/%d/%Y")) %>% 
  arrange(Macroplot_Name, SampleEvent_Date, MethodData_index) %>% 
  select(!c(MethodData_fieldTeam, MethodData_entryTeam))
```

```{r}
#diffdf(FuelsFine_DataDepot, FuelsFine_DataFFI)
```

```{r}
FuelsFine_DataDepot <- FuelsFine_DataDepot %>% 
  select(!c("OrganizationId","AdminUnitId","MacroplotId","SampleEventId","MethodId","Organization_Name","AdminUnit_Comment","Macroplot_LocatedBy","Macroplot_DdLat","Macroplot_DdLong","Macroplot_UtmX (m)","Macroplot_UtmY (m)","Macroplot_UtmZone","Macroplot_Datum","Macroplot_Pdop","Macroplot_Precision","Macroplot_DateIn","Macroplot_FutureVisit","Macroplot_DateOut","Macroplot_Elevation","Macroplot_ElevationUnits","Macroplot_Azimuth","Macroplot_Aspect","Macroplot_SlopeHill (%)","Macroplot_SlopeTransect (%)","Macroplot_StartPoint","Macroplot_Directions","Macroplot_Comment","Macroplot_Metadata","SampleEvent_Who","SampleEvent_Comment","SampleEvent_UserVariables","SampleEvent_DefaultMonitoringStatus","SampleData_Executed","SampleData_SampleData","sampleEventId","MacroPlotId","MethodDataId","MethodData_id","MethodData_createdDate","MethodData_updatedDate","MethodData_deletedDate")) %>% 
  select(!c(Macroplot_Purpose,Macroplot_Type,Macroplot_UV1,Macroplot_UV2,Macroplot_UV3,Macroplot_UV4,Macroplot_UV5,Macroplot_UV6,Macroplot_UV7,Macroplot_UV8,SampleEvent_TreatmentUnit)) %>% 
  select(!c(Macroplot_Name))


FuelsFine_DataFFI <- FuelsFine_DataFFI %>% 
  select(!c("MonitoringStatus_Name","MonitoringStatus_Prefix","MonitoringStatus_Base","MonitoringStatus_Suffix","MonitoringStatus_Order")) %>% 
  select(!c(Macroplot_Purpose,Macroplot_Type,Macroplot_UV1,Macroplot_UV2,Macroplot_UV3,Macroplot_UV4,Macroplot_UV5,Macroplot_UV6,Macroplot_UV7,Macroplot_UV8,SampleEvent_TreatmentUnit)) %>% 
  select(!c(Macroplot_Name))
```

```{r}
diffdf(FuelsFine_DataDepot, FuelsFine_DataFFI)
```

## Post Burn

## Trees

```{r}
Trees_DataDepot <- Trees_M %>% 
  mutate(SampleEvent_Date = as.Date(SampleEvent_Date, "%m/%d/%Y")) %>% 
  arrange(Macroplot_Name, SampleEvent_Date, MethodData_index) %>% 
  select(!c(MethodData_fieldTeam, MethodData_entryTeam))
Trees_DataFFI <- Trees_O %>% 
  mutate(SampleEvent_Date = as.Date(SampleEvent_Date, "%m/%d/%Y")) %>% 
  arrange(Macroplot_Name, SampleEvent_Date, MethodData_index) %>% 
  select(!c(MethodData_fieldTeam, MethodData_entryTeam))
```

```{r}
#diffdf(Trees_DataDepot, Trees_DataFFI)
```

```{r}
Trees_DataDepot <- Trees_DataDepot %>% 
  select(!c("OrganizationId","AdminUnitId","MacroplotId","SampleEventId","MethodId","Organization_Name","AdminUnit_Comment","Macroplot_LocatedBy","Macroplot_DdLat","Macroplot_DdLong","Macroplot_UtmX (m)","Macroplot_UtmY (m)","Macroplot_UtmZone","Macroplot_Datum","Macroplot_Pdop","Macroplot_Precision","Macroplot_DateIn","Macroplot_FutureVisit","Macroplot_DateOut","Macroplot_Elevation","Macroplot_ElevationUnits","Macroplot_Azimuth","Macroplot_Aspect","Macroplot_SlopeHill (%)","Macroplot_SlopeTransect (%)","Macroplot_StartPoint","Macroplot_Directions","Macroplot_Comment","Macroplot_Metadata","SampleEvent_Who","SampleEvent_Comment","SampleEvent_UserVariables","SampleEvent_DefaultMonitoringStatus","SampleData_Executed","SampleData_SampleData","sampleEventId","MacroPlotId","MethodDataId","MethodData_id","MethodData_createdDate","MethodData_updatedDate","MethodData_deletedDate")) %>% 
  select(!c("Species_SourceEntityId","Species_LocalSpeciesId","Species_MasterSpeciesId","Species_AuxSpeciesId","Species_ITISTaxonomicSerialNumber","Species_SymbolLocal","Species_Symbol","Species_ScientificName","Species_CommonNameLocal","Species_CommonName","Species_Genus","Species_Family","Species_NotBiological","Species_Nativity","Species_NativityLocal","Species_Invasive","Species_LifeFormName","Species_LifeFormNameLocal","Species_Description","Species_LifeCycle","Species_LifeCycleLocal","Species_Cultural","Species_Concern","Species_Retired","Species_Comment","Species_UV1","Species_UV2","Species_UV3","MethodData_sppGuid")) %>% 
  select(!c("MethodData_density","MethodData_basalArea")) %>% 
  select(!c(Macroplot_Purpose,Macroplot_Type,Macroplot_UV1,Macroplot_UV2,Macroplot_UV3,Macroplot_UV4,Macroplot_UV5,Macroplot_UV6,Macroplot_UV7,Macroplot_UV8,SampleEvent_TreatmentUnit)) %>% 
  select(!c(Macroplot_Name))


Trees_DataFFI <- Trees_DataFFI %>% 
  select(!c("MonitoringStatus_Name","MonitoringStatus_Prefix","MonitoringStatus_Base","MonitoringStatus_Suffix","MonitoringStatus_Order")) %>% 
  select(!c("Species_LifeCycleLocal","Species_NotBiological","Species_LifeFormNameLocal","Species_Family","Species_Genus","Species_ScientificName","Species_NativityLocal","Species_Invasive")) %>% 
  select(!c(Macroplot_Purpose,Macroplot_Type,Macroplot_UV1,Macroplot_UV2,Macroplot_UV3,Macroplot_UV4,Macroplot_UV5,Macroplot_UV6,Macroplot_UV7,Macroplot_UV8,SampleEvent_TreatmentUnit)) %>% 
  select(!c(Macroplot_Name))
```

```{r}
diffdf(Trees_DataDepot, Trees_DataFFI)
```

## Seedlings

## Shrubs

## Herbs Species Comp

```{r}
HerbsSpComp_DataDepot <- HerbsSpComp_M %>% 
  mutate(SampleEvent_Date = as.Date(SampleEvent_Date, "%m/%d/%Y")) %>% 
  arrange(Macroplot_Name, SampleEvent_Date, MethodData_index) %>% 
  select(!c(MethodData_fieldTeam, MethodData_entryTeam)) %>% 
  dplyr::rename(MethodData_symbolLocal = MethodData_localSpeciesSymbol)
HerbsSpComp_DataFFI <- HerbsSpComp_O %>% 
  mutate(SampleEvent_Date = as.Date(SampleEvent_Date, "%m/%d/%Y")) %>% 
  arrange(Macroplot_Name, SampleEvent_Date, MethodData_index) %>% 
  select(!c(MethodData_fieldTeam, MethodData_entryTeam))
```

```{r}
#diffdf(HerbsSpComp_DataDepot, HerbsSpComp_DataFFI)
```

```{r}
HerbsSpComp_DataDepot <- HerbsSpComp_DataDepot %>% 
  select(!c("OrganizationId","AdminUnitId","MacroplotId","SampleEventId","MethodId","Organization_Name","AdminUnit_Comment","Macroplot_LocatedBy","Macroplot_DdLat","Macroplot_DdLong","Macroplot_UtmX (m)","Macroplot_UtmY (m)","Macroplot_UtmZone","Macroplot_Datum","Macroplot_Pdop","Macroplot_Precision","Macroplot_DateIn","Macroplot_FutureVisit","Macroplot_DateOut","Macroplot_Elevation","Macroplot_ElevationUnits","Macroplot_Azimuth","Macroplot_Aspect","Macroplot_SlopeHill (%)","Macroplot_SlopeTransect (%)","Macroplot_StartPoint","Macroplot_Directions","Macroplot_Comment","Macroplot_Metadata","SampleEvent_Who","SampleEvent_Comment","SampleEvent_UserVariables","SampleEvent_DefaultMonitoringStatus","SampleData_Executed","SampleData_SampleData","sampleEventId","MacroPlotId","MethodDataId","MethodData_id","MethodData_createdDate","MethodData_updatedDate","MethodData_deletedDate")) %>% 
  select(!c("Species_SourceEntityId","Species_LocalSpeciesId","Species_MasterSpeciesId","Species_AuxSpeciesId","Species_ITISTaxonomicSerialNumber","Species_SymbolLocal","Species_Symbol","Species_ScientificName","Species_CommonNameLocal","Species_CommonName","Species_Genus","Species_Family","Species_NotBiological","Species_Nativity","Species_NativityLocal","Species_Invasive","Species_LifeFormName","Species_LifeFormNameLocal","Species_Description","Species_LifeCycle","Species_LifeCycleLocal","Species_Cultural","Species_Concern","Species_Retired","Species_Comment","Species_UV1","Species_UV2","Species_UV3","MethodData_sppGuid")) %>% 
  select(!c("MethodData_localSpeciesId","MethodData_speciesId")) %>% 
  select(!c(Macroplot_Purpose,Macroplot_Type,Macroplot_UV1,Macroplot_UV2,Macroplot_UV3,Macroplot_UV4,Macroplot_UV5,Macroplot_UV6,Macroplot_UV7,Macroplot_UV8,SampleEvent_TreatmentUnit)) %>% 
  select(!c(Macroplot_Name))


HerbsSpComp_DataFFI <- HerbsSpComp_DataFFI %>% 
  select(!c("MonitoringStatus_Name","MonitoringStatus_Prefix","MonitoringStatus_Base","MonitoringStatus_Suffix","MonitoringStatus_Order")) %>% 
  select(!c("Species_LifeCycleLocal","Species_NotBiological","Species_LifeFormNameLocal","Species_Family","Species_Genus","Species_ScientificName","Species_NativityLocal","Species_Invasive")) %>% 
  select(!c(Macroplot_Purpose,Macroplot_Type,Macroplot_UV1,Macroplot_UV2,Macroplot_UV3,Macroplot_UV4,Macroplot_UV5,Macroplot_UV6,Macroplot_UV7,Macroplot_UV8,SampleEvent_TreatmentUnit)) %>% 
  select(!c(Macroplot_Name))
```

```{r}
diffdf(HerbsSpComp_DataDepot, HerbsSpComp_DataFFI)
```

## Herbs Points

```{r}
HerbsPoints_DataDepot <- HerbsPoints_M %>% 
  mutate(SampleEvent_Date = as.Date(SampleEvent_Date, "%m/%d/%Y")) %>% 
  arrange(Macroplot_Name, SampleEvent_Date, MethodData_index) %>% 
  select(!c(MethodData_fieldTeam, MethodData_entryTeam)) %>% 
  dplyr::rename(MethodData_symbolLocal = MethodData_localSpeciesSymbol)
HerbsPoints_DataFFI <- HerbsPoints_O %>% 
  mutate(SampleEvent_Date = as.Date(SampleEvent_Date, "%m/%d/%Y")) %>% 
  arrange(Macroplot_Name, SampleEvent_Date, MethodData_index) %>% 
  select(!c(MethodData_fieldTeam, MethodData_entryTeam))
```

```{r}
#diffdf(HerbsPoints_DataDepot, HerbsPoints_DataFFI)
```

```{r}
HerbsPoints_DataDepot <- HerbsPoints_DataDepot %>% 
  select(!c("OrganizationId","AdminUnitId","MacroplotId","SampleEventId","MethodId","Organization_Name","AdminUnit_Comment","Macroplot_LocatedBy","Macroplot_DdLat","Macroplot_DdLong","Macroplot_UtmX (m)","Macroplot_UtmY (m)","Macroplot_UtmZone","Macroplot_Datum","Macroplot_Pdop","Macroplot_Precision","Macroplot_DateIn","Macroplot_FutureVisit","Macroplot_DateOut","Macroplot_Elevation","Macroplot_ElevationUnits","Macroplot_Azimuth","Macroplot_Aspect","Macroplot_SlopeHill (%)","Macroplot_SlopeTransect (%)","Macroplot_StartPoint","Macroplot_Directions","Macroplot_Comment","Macroplot_Metadata","SampleEvent_Who","SampleEvent_Comment","SampleEvent_UserVariables","SampleEvent_DefaultMonitoringStatus","SampleData_Executed","SampleData_SampleData","sampleEventId","MacroPlotId","MethodDataId","MethodData_id","MethodData_createdDate","MethodData_updatedDate","MethodData_deletedDate")) %>% 
  select(!c("Species_SourceEntityId","Species_LocalSpeciesId","Species_MasterSpeciesId","Species_AuxSpeciesId","Species_ITISTaxonomicSerialNumber","Species_SymbolLocal","Species_Symbol","Species_ScientificName","Species_CommonNameLocal","Species_CommonName","Species_Genus","Species_Family","Species_NotBiological","Species_Nativity","Species_NativityLocal","Species_Invasive","Species_LifeFormName","Species_LifeFormNameLocal","Species_Description","Species_LifeCycle","Species_LifeCycleLocal","Species_Cultural","Species_Concern","Species_Retired","Species_Comment","Species_UV1","Species_UV2","Species_UV3","MethodData_sppGuid")) %>% 
  select(!c("MethodData_localSpeciesId","MethodData_speciesId","MethodData_cover")) %>% 
  select(!c(Macroplot_Purpose,Macroplot_Type,Macroplot_UV1,Macroplot_UV2,Macroplot_UV3,Macroplot_UV4,Macroplot_UV5,Macroplot_UV6,Macroplot_UV7,Macroplot_UV8,SampleEvent_TreatmentUnit)) %>% 
  select(!c(Macroplot_Name))


HerbsPoints_DataFFI <- HerbsPoints_DataFFI %>% 
  select(!c("MonitoringStatus_Name","MonitoringStatus_Prefix","MonitoringStatus_Base","MonitoringStatus_Suffix","MonitoringStatus_Order")) %>% 
  select(!c("Species_LifeCycleLocal","Species_NotBiological","Species_LifeFormNameLocal","Species_Family","Species_Genus","Species_ScientificName","Species_NativityLocal","Species_Invasive")) %>% 
  select(!c(Macroplot_Purpose,Macroplot_Type,Macroplot_UV1,Macroplot_UV2,Macroplot_UV3,Macroplot_UV4,Macroplot_UV5,Macroplot_UV6,Macroplot_UV7,Macroplot_UV8,SampleEvent_TreatmentUnit)) %>% 
  select(!c(Macroplot_Name))
```

```{r}
diffdf(HerbsPoints_DataDepot, HerbsPoints_DataFFI)
```

## Herbs Frequency

# COLUMNS

-   If all successfully load, this means that column names match across all units and protocols

## All Protocols

```{r}
data <- HerbsPoints_M
```

```{r}
data_ID <- data %>% 
  select(c("OrganizationId","AdminUnitId","MacroplotId","MacroPlotId","SampleEventId","sampleEventId","MethodId","MethodDataId","MethodData_id"))

data_Macroplot <- data %>% 
  select(c("Organization_Name","AdminUnit_Name","AdminUnit_Comment","Macroplot_Name","Macroplot_Purpose","Macroplot_LocatedBy","Macroplot_Type","Macroplot_DdLat","Macroplot_DdLong","Macroplot_UtmX (m)","Macroplot_UtmY (m)","Macroplot_UtmZone","Macroplot_Pdop","Macroplot_Precision","Macroplot_DateIn","Macroplot_DateOut","Macroplot_Elevation","Macroplot_ElevationUnits","Macroplot_Azimuth","Macroplot_Aspect","Macroplot_SlopeHill (%)","Macroplot_SlopeTransect (%)","Macroplot_StartPoint","Macroplot_Directions","Macroplot_Comment","Macroplot_Datum","Macroplot_Metadata","Macroplot_FutureVisit","Macroplot_UV1","Macroplot_UV2","Macroplot_UV3","Macroplot_UV4","Macroplot_UV5","Macroplot_UV6","Macroplot_UV7","Macroplot_UV8")) %>% 
  unique()

data_SampleEvent <- data %>% 
  select(c("Macroplot_Name","SampleEvent_Date","SampleEvent_Who","SampleEvent_Comment","SampleEvent_UserVariables","SampleEvent_DefaultMonitoringStatus","SampleEvent_TreatmentUnit","SampleData_Executed","SampleData_SampleData")) %>% 
  unique()

data_MethodData <- data %>% 
  select(c("Macroplot_Name","SampleEvent_Date","MethodData_visited","MethodData_fieldTeam","MethodData_entryTeam","MethodData_uV1Desc","MethodData_uV2Desc","MethodData_uV3Desc","MethodData_saComment","MethodData_createdDate","MethodData_updatedDate","MethodData_deletedDate","MethodData_comment","MethodData_uV1","MethodData_uV2","MethodData_uV3")) %>% 
  unique()
```

Species

```{r}
data_SpeciesData <- data %>% 
  select(c("Species_SourceEntityId","Species_LocalSpeciesId","Species_MasterSpeciesId","Species_AuxSpeciesId","Species_ITISTaxonomicSerialNumber","Species_SymbolLocal","Species_Symbol","Species_ScientificName","Species_CommonNameLocal","Species_CommonName","Species_Genus","Species_Family","Species_NotBiological","Species_Nativity","Species_NativityLocal","Species_Invasive","Species_LifeFormName","Species_LifeFormNameLocal","Species_Description","Species_LifeCycle","Species_LifeCycleLocal","Species_Cultural","Species_Concern","Species_Retired","Species_Comment","Species_UV1","Species_UV2","Species_UV3","MethodData_sppGuid"))
```

## Fuels 1000Hr (CWD)

English

```{r}
# select method data
data_MethodData_Data <- Fuels1000_E %>% 
  select(c("Macroplot_Name","SampleEvent_Date","MethodData_index","MethodData_numTran (num.)","MethodData_tranLen (ft)","MethodData_transect (num.)","MethodData_slope (%)","MethodData_logNum (num.)","MethodData_dia (in.)","MethodData_decayCl","MethodData_cWDFuConSt")) %>% 
  arrange(MethodData_index)
```

Metric

```{r}
# select method data
data_MethodData_Data <- Fuels1000_M %>% 
  select(c("Macroplot_Name","SampleEvent_Date","MethodData_index","MethodData_numTran (num.)","MethodData_tranLen (m)","MethodData_transect (num.)","MethodData_slope (%)","MethodData_logNum (num.)","MethodData_dia (cm)","MethodData_decayCl","MethodData_cWDFuConSt")) %>% 
  arrange(MethodData_index)
```

## Fuels Duff Litter (DL)

English

```{r}
# select method data
data_MethodData_Data <- FuelsDuffLitt_E %>% 
  select(c("Macroplot_Name","SampleEvent_Date","MethodData_index","MethodData_numTran (num.)","MethodData_transect (num.)","MethodData_sampLoc (ft)","MethodData_offSet","MethodData_littDep (in.)","MethodData_duffDep (in.)","MethodData_fuelbedDep (in.)","MethodData_dLFuConSt")) %>% 
  arrange(MethodData_index)
```

Metric

```{r}
# select method data
data_MethodData_Data <- FuelsDuffLitt_M %>% 
  select(c("Macroplot_Name","SampleEvent_Date","MethodData_index","MethodData_numTran (num.)","MethodData_transect (num.)","MethodData_sampLoc (m)","MethodData_offSet","MethodData_littDep (cm)","MethodData_duffDep (cm)","MethodData_fuelbedDep (cm)","MethodData_dLFuConSt")) %>% 
  arrange(MethodData_index)
```

## Fuels Fine (FWD)

English

```{r}
# select method data
data_MethodData_Data <- FuelsFine_E %>% 
  select(c("Macroplot_Name","SampleEvent_Date","MethodData_numTran (num.)","MethodData_oneHrTranLen (ft)","MethodData_tenHrTranLen (ft)","MethodData_hunHrTranLen (ft)","MethodData_index","MethodData_transect (num.)","MethodData_azimuth (&#166;)","MethodData_slope (%)","MethodData_oneHr","MethodData_tenHr","MethodData_hunHr","MethodData_fWDFuConSt")) %>% 
  arrange(MethodData_index)
```

Metric

```{r}
# select method data
data_MethodData_Data <- FuelsFine_M %>% 
  select(c("Macroplot_Name","SampleEvent_Date","MethodData_numTran (num.)","MethodData_oneHrTranLen (m)","MethodData_tenHrTranLen (m)","MethodData_hunHrTranLen (m)","MethodData_index","MethodData_transect (num.)","MethodData_azimuth (&#166;)","MethodData_slope (%)","MethodData_oneHr","MethodData_tenHr","MethodData_hunHr","MethodData_fWDFuConSt")) %>% 
  arrange(MethodData_index)
```

## Post Burn

English

```{r}
#values_data <- names(PostBurn_E)
```

Metric

```{r}
#values_data <- names(PostBurn_M)
```

## Trees

English

```{r}
# select method data
data_MethodData_Data <- Trees_E %>% 
  select(c("Macroplot_Name","SampleEvent_Date","MethodData_macroPlotSize (ac)","MethodData_snagPlotSize (ac)","MethodData_breakPntDia","MethodData_index","MethodData_isVerified","MethodData_qTR (num.)","MethodData_subFrac (num.)","MethodData_tagNo (num.)","MethodData_symbolLocal","MethodData_status","MethodData_dBH (in.)","MethodData_ht (ft)","MethodData_crwnRto (%)","MethodData_crwnCl","MethodData_crFuBHt (ft)","MethodData_liCrBHt (ft)","MethodData_crwnRad (ft)","MethodData_age (yrs)","MethodData_grwthRt (in.)","MethodData_mort","MethodData_decayCl","MethodData_laddBaseHt (ft)","MethodData_laddMaxHt (ft)","MethodData_dRC (in.)","MethodData_nuLiStems","MethodData_nuDeStems","MethodData_eqDia (in.)","MethodData_xCoord (ft)","MethodData_yCoord (ft)","MethodData_cKR","MethodData_charHt (ft)","MethodData_scorchHt (ft)","MethodData_crScPct (%)","MethodData_damCd1","MethodData_damSev1 (num.)","MethodData_damCd2","MethodData_damSev2 (num.)","MethodData_damCd3","MethodData_damSev3 (num.)","MethodData_damCd4","MethodData_damSev4 (num.)","MethodData_damCd5","MethodData_damSev5 (num.)","MethodData_density","MethodData_basalArea")) %>% 
  arrange(MethodData_index)
```

Metric

```{r}
# select method data
data_MethodData_Data <- Trees_M %>% 
  select(c("Macroplot_Name","SampleEvent_Date","MethodData_macroPlotSize (ha)","MethodData_snagPlotSize (ha)","MethodData_breakPntDia","MethodData_index","MethodData_isVerified","MethodData_qTR (num.)","MethodData_subFrac (num.)","MethodData_tagNo (num.)","MethodData_symbolLocal","MethodData_status","MethodData_dBH (cm)","MethodData_ht (m)","MethodData_crwnRto (%)","MethodData_crwnCl","MethodData_crFuBHt (m)","MethodData_liCrBHt (m)","MethodData_crwnRad (m)","MethodData_age (yrs)","MethodData_grwthRt (cm)","MethodData_mort","MethodData_decayCl","MethodData_laddBaseHt (m)","MethodData_laddMaxHt (m)","MethodData_dRC (cm)","MethodData_nuLiStems","MethodData_nuDeStems","MethodData_eqDia (cm)","MethodData_xCoord (m)","MethodData_yCoord (m)","MethodData_cKR","MethodData_charHt (m)","MethodData_scorchHt (m)","MethodData_crScPct (%)","MethodData_damCd1","MethodData_damSev1 (num.)","MethodData_damCd2","MethodData_damSev2 (num.)","MethodData_damCd3","MethodData_damSev3 (num.)","MethodData_damCd4","MethodData_damSev4 (num.)","MethodData_damCd5","MethodData_damSev5 (num.)","MethodData_density","MethodData_basalArea")) %>% 
  arrange(MethodData_index)
```

## Seedlings

English

```{r}
#values_data <- names(Seedlings_E)
```

Metric

```{r}
#values_data <- names(Seedlings_M)
```

## Shrubs

English

```{r}
#values_data <- names(Shrubs_E)
```

Metric

```{r}
#values_data <- names(Shrubs_M)
```

## Herbs Species Comp

English

```{r}
# select method data
data_MethodData_Data <- HerbsSpComp_E %>% 
  select(c("Macroplot_Name","SampleEvent_Date","MethodData_minCovLevel (%)","MethodData_area (ac)","MethodData_index","MethodData_status (num.)","MethodData_sizeCl (num.)","MethodData_ageCl","MethodData_cover","MethodData_height (ft)","MethodData_localSpeciesId","MethodData_localSpeciesSymbol","MethodData_speciesId")) %>% 
  arrange(MethodData_index)
```

Metric

```{r}
# select method data
data_MethodData_Data <- HerbsSpComp_M %>% 
  select(c("Macroplot_Name","SampleEvent_Date","MethodData_minCovLevel (%)","MethodData_area (ha)","MethodData_index","MethodData_status (num.)","MethodData_sizeCl (num.)","MethodData_ageCl","MethodData_cover","MethodData_height (m)","MethodData_localSpeciesId","MethodData_localSpeciesSymbol","MethodData_speciesId")) %>% 
  arrange(MethodData_index)
```

## Herbs Points

English

```{r}
# select method data
data_MethodData_Data <- HerbsPoints_E %>% 
  select(c("Macroplot_Name","SampleEvent_Date","MethodData_numTran (num.)","MethodData_tranLen (ft)","MethodData_numPtsTran (num.)","MethodData_offset (ft)","MethodData_index","MethodData_transect (num.)","MethodData_point (num.)","MethodData_tape (num.)","MethodData_order (num.)","MethodData_height (ft)","MethodData_status","MethodData_cover","MethodData_canopyLayer","MethodData_localSpeciesId","MethodData_localSpeciesSymbol","MethodData_speciesId")) %>% 
  arrange(MethodData_index)
```

Metric

```{r}
# select method data
data_MethodData_Data <- HerbsPoints_M %>% 
  select(c("Macroplot_Name","SampleEvent_Date","MethodData_numTran (num.)","MethodData_tranLen (m)","MethodData_numPtsTran (num.)","MethodData_offset (m)","MethodData_index","MethodData_transect (num.)","MethodData_point (num.)","MethodData_tape (num.)","MethodData_order (num.)","MethodData_height (m)","MethodData_status","MethodData_cover","MethodData_canopyLayer","MethodData_localSpeciesId","MethodData_localSpeciesSymbol","MethodData_speciesId")) %>% 
  arrange(MethodData_index)
```

## Herbs Frequency

English

```{r}
# # select method data
# data_MethodData_Data <- HerbsFrequency_E %>% 
#   select(c("MethodData_numTran (num.)", "MethodData_tranLen (ft)","MethodData_numQuadTran (num.)","MethodData_quadLen (in.)","MethodData_quadWid (in.)","MethodData_nFRatio","MethodData_nFNum","MethodData_index","MethodData_transect (num.)","MethodData_quadrat (num.)","MethodData_status (num.)","MethodData_nRF (num.)","MethodData_typeCov","MethodData_cover (%)","MethodData_height (ft)","MethodData_quadCover","MethodData_frequency","MethodData_localSpeciesId","MethodData_localSpeciesSymbol","MethodData_speciesId")) %>% 
#   arrange(MethodData_index)
```

Metric

```{r}
# # select method data
# data_MethodData_Data <- HerbsFrequency_M %>% 
#   select(c("MethodData_numTran (num.)", "MethodData_tranLen (m)","MethodData_numQuadTran (num.)","MethodData_quadLen (cm)","MethodData_quadWid (cm)","MethodData_nFRatio","MethodData_nFNum","MethodData_index","MethodData_transect (num.)","MethodData_quadrat (num.)","MethodData_status (num.)","MethodData_nRF (num.)","MethodData_typeCov","MethodData_cover (%)","MethodData_height (m)","MethodData_quadCover","MethodData_frequency","MethodData_localSpeciesId","MethodData_localSpeciesSymbol","MethodData_speciesId")) %>% 
#   arrange(MethodData_index)
```

# METRIC VS ENGLISH

## Fuels 1000Hr (CWD)

Header

```{r}
# select headers
data_MethodData_Header_E <- Fuels1000_E %>% 
  select(c("Macroplot_Name","SampleEvent_Date","MethodData_tranLen (ft)")) %>% 
  unique()

data_MethodData_Header_M <- Fuels1000_M %>% 
  select(c("Macroplot_Name","SampleEvent_Date","MethodData_tranLen (m)")) %>% 
  unique()

data_MethodData_Header_O <- Fuels1000_O %>% 
  select(c("TranLen")) %>% 
  unique() %>% 
  rename("MethodData_tranLen (org ft)" = TranLen)


data_MethodData_Header_merge <- merge(data_MethodData_Header_E, data_MethodData_Header_O)
data_MethodData_Header_units <- merge(data_MethodData_Header_M, data_MethodData_Header_merge)
remove(data_MethodData_Header_merge, data_MethodData_Header_O, data_MethodData_Header_E, data_MethodData_Header_M)
```

Data

```{r}
# select data
data_MethodData_Data_E <- Fuels1000_E %>% 
  select(c("Macroplot_Name","SampleEvent_Date","MethodData_index","MethodData_transect (num.)","MethodData_dia (in.)")) %>% 
  arrange(MethodData_index)

data_MethodData_Data_M <- Fuels1000_M %>% 
  select(c("Macroplot_Name","SampleEvent_Date","MethodData_index","MethodData_transect (num.)","MethodData_dia (cm)")) %>% 
  arrange(MethodData_index)

data_MethodData_Data_O <- Fuels1000_O %>% 
  select(c("Index","Transect","Dia")) %>% 
  rename("MethodData_index" = Index,
         "MethodData_transect (num.)" = Transect,
         "MethodData_dia (org in.)" = Dia) %>% 
  arrange(MethodData_index)

data_MethodData_Data_merge <- merge(data_MethodData_Data_E, data_MethodData_Data_O)
data_MethodData_Data_units <- merge(data_MethodData_Data_M, data_MethodData_Data_merge)
remove(data_MethodData_Data_merge, data_MethodData_Data_O, data_MethodData_Data_E, data_MethodData_Data_M)
```

## Fuels Duff Litter (DL)

Header

Data

## Fuels Fine (FWD)

Header

Data

## Post Burn

Header

Data

## Trees

Header

Data

```{r}
"MethodData_macroPlotSize (ha)","MethodData_snagPlotSize (ha)","MethodData_dBH (cm)","MethodData_ht (m)","MethodData_crFuBHt (m)","MethodData_liCrBHt (m)","MethodData_crwnRad (m)","MethodData_grwthRt (cm)","MethodData_laddBaseHt (m)","MethodData_laddMaxHt (m)","MethodData_dRC (cm)","MethodData_eqDia (cm)","MethodData_xCoord (m)","MethodData_yCoord (m)","MethodData_charHt (m)","MethodData_scorchHt (m)","MethodData_density","MethodData_basalArea"
```

## Seedlings

Header

Data

## Shrubs

Header

Data

## Herbs Species Comp

Header

Data

## Herbs Points

Header

Data

## Herbs Frequency

Header

Data

# PROJECT UNIT REPORT

[Procedure:]{.underline}

-   Check that columns match expected

```{r}
# Set parameters 
data <- ProjectUnitReport
values_data <- names(data)
values_valid <- c("Macroplot", "ProjectUnit", "Multi_PU")
MissingColumn <- setdiff(values_data, values_valid)
if(length(MissingColumn) == 0) {
  MissingColumn <- "none"
} else {
  MissingColumn <- paste((MissingColumn), collapse = ", ")
}

data$MissingColumn <- MissingColumn
query <- "Project Unit Report"
query_message <- "Missing/Extra Columns"
values_data <- data$MissingColumn
values_valid <- "none"
values_check <- values_data == values_valid

# Identify errors
errors_ProjectUnitReport_Columns <- qaqc(data, query, query_message, values_check)
errors_ProjectUnitReport_Columns <- unique(errors_ProjectUnitReport_Columns)
```

-   Check that Macroplot is not blank

```{r}
# Set parameters 
data <- ProjectUnitReport
query <- "Project Unit Report"
query_message <- "Macroplot" 
values_data <- data$Macroplot
values_valid <- ""
values_check <- values_data != values_valid

# Identify errors
errors_ProjectUnitReport_Macroplot <- qaqc(data, query, query_message, values_check)
```

-   Check that ProjectUnit is not blank

```{r}
# Set parameters 
data <- ProjectUnitReport
query <- "Project Unit Report"
query_message <- "Project Unit" 
values_data <- data$ProjectUnit
values_valid <- ""
values_check <- values_data != values_valid

# Identify errors
errors_ProjectUnitReport_ProjectUnit <- qaqc(data, query, query_message, values_check)
```

-   Check that Multi_PU = N or Y. If Multi_PU = Y, you will need to isolate which Project Unit contains the primary data for the analysis of interest.

```{r}
# Set parameters 
data <- ProjectUnitReport
query <- "Project Unit Report"
query_message <- "Multi Project Units" 
values_data <- data$Multi_PU
values_valid <- c("N")
values_check <- values_data %in% values_valid

# Identify errors
errors_ProjectUnitReport_MultiPU <- qaqc(data, query, query_message, values_check)
```

### Combine Project Unit Report Errors {.hidden}

```{r}
errors_ProjectUnitReport <- unique(rbind(errors_ProjectUnitReport_Quotes, errors_ProjectUnitReport_Commas, errors_ProjectUnitReport_Columns, errors_ProjectUnitReport_Macroplot, errors_ProjectUnitReport_ProjectUnit, errors_ProjectUnitReport_MultiPU))

remove(errors_ProjectUnitReport_Quotes, errors_ProjectUnitReport_Commas, errors_ProjectUnitReport_Columns, errors_ProjectUnitReport_Macroplot, errors_ProjectUnitReport_ProjectUnit, errors_ProjectUnitReport_MultiPU)

if(nrow(errors_ProjectUnitReport) > 1) {
  errors_ProjectUnitReport <- errors_ProjectUnitReport %>%
    filter(Error != "No Error")
} else {
  errors_ProjectUnitReport <- errors_ProjectUnitReport}
```
