---
title: "FFI Database Summary"
subtitle: Northeast Region
output:
  word_document:
    toc: true
    toc_depth: 2
  pdf_document:
    toc: true
    toc_depth: 2
  html_document:
    theme: readable
    highlight: null
    toc: true
    toc_depth: 2
    toc_float:
      smooth_scroll: true
    code_download: true
---

# BEFORE STARTING

### Setup {.hidden}

```{r}
## Markdown Options
knitr::opts_chunk$set(echo = FALSE, error = FALSE, warning = FALSE, message = FALSE)
```

```{r}
## Install packages (if needed)

# install.packages("tidyverse")
# install.packages("kableExtra")
# install.packages("ggplot2")
```

```{r}
## Load Packages

# "tidyverse" has lots of useful functions for data cleaning
library(tidyverse)
# "kableExtra" is used to produce formatted tables
library(kableExtra)
library(ggplot2)
library(stringr)
library(DT)
library(fs)
```

### Adjust File Paths

```{r}
## Adjust File Paths
#path_file <- "E:/Allie/FireFX_NER/FFI Data Management/R Outputs/"
path_file <- "C:/Users/alalor/OneDrive - DOI/NER/FireFX/FFI Data Management/R Outputs/"
path_data <- paste0(path_file, "ALL/ALL_")
path_save <- paste0(path_file, "ALL/Calculations/ALL_")
```

### Load Data {.hidden}

```{r}
# Load in data

# Fuels1000 <- read.csv(paste0(path_data, "Data_Surface Fuels - 1000Hr.csv"))
# FuelsDuffLitt <- read.csv(paste0(path_data, "Data_Surface Fuels - Duff_Litter.csv"))
# FuelsFine <- read.csv(paste0(path_data, "Data_Surface Fuels - Fine.csv"))

# Trees <- read.csv(paste0(path_data, "Data_Trees - Individuals (metric).csv"))
# Seedlings <- read.csv(paste0(path_data, "Data_Density - Quadrats (metric).csv"))

HerbsPoints <- read.csv(paste0(path_data, "Data_Cover - Points (metric).csv"))
HerbsSpComp <- read.csv(paste0(path_data, "Data_Cover - Species Composition (metric).csv"))

# PostBurn <- read.csv(paste0(path_data, "Data_Post Burn Severity (metric).csv"))
# Shrubs <- read.csv(paste0(path_data, "Data_Density - Belts (metric).csv"))
```

# Surface Fuels

## Fuels 1000

```{r calculate fuel loads, include=FALSE}
# -------------------------- #
# ---- 1,000-Hour Fuels ---- #
# -------------------------- #

# ---- Function to calculate 1000-hr fuels for any park dataset ---- #
calculate_coarse_fuels <- function(fuels_df) {


  # ---- Step 1: Ensure Transect is numeric BEFORE calculations ---- #
  fuels_df <- fuels_df %>% 
    mutate(
      SampleEventDate = ymd(SampleEventDate),
      Transect = suppressWarnings(as.numeric(Transect)),
      DecayCl = suppressWarnings(as.numeric(DecayCl)),
      Dia = suppressWarnings(as.numeric(Dia))
      )
  
  # ---- Step 2: Compute per-log contributions ---- #
  a <- 1.0
  s_sound <- 0.4
  s_rotten <- 0.3
  conversion_factor <- 11.64

  fuels_processed <- fuels_df %>%
    filter(DecayCl %in% c(3, 4)) %>%
    mutate(
      # a = 1.0,
      # s_sound = 0.4,
      # s_rotten = 0.3,
      # conversion_factor = 11.64,
      D2 = Dia^2,
      s = if_else(DecayCl == 3, s_sound, s_rotten),
      slope_correction = sqrt(1 + (Slope / 100)^2),
      Load = (conversion_factor * D2 * s * a * slope_correction) / TranLen,
      Load_Adjusted = Load / NumTran
    )

  # ---- Step 3A: Summarise computed loads (only where logs existed) ---- #
  loads_per_transect <- fuels_processed %>% 
   group_by(AdministrationUnit_Name, Purpose, Type, Macroplot, MonStatus, Transect) %>% 
    dplyr::summarise(
      ThousHrTranLen           = TranLen,
      ThousHrSound             = sum((DecayCl == 3), na.rm = TRUE),
      ThousHrRott              = sum((DecayCl == 4), na.rm = TRUE),
      ThousHr                  = sum((DecayCl %in% c(3,4)), na.rm = TRUE),
      ThousHrSound_FuelLoad    = sum(Load[DecayCl == 3], na.rm = TRUE),
      ThousHrRott_FuelLoad     = sum(Load[DecayCl == 4], na.rm = TRUE),
      ThousHr_FuelLoad         = sum(Load, na.rm = TRUE),
      .groups = "drop"
    ) %>%
    mutate(Transect = suppressWarnings(as.numeric(Transect)))
  
  
  # ---- Step 3B: Create full grid of expected transects per plot/year ---- #
  all_transects <- fuels_df %>%
    select(AdministrationUnit_Name, Purpose, Type, Macroplot, MonStatus, NumTran, Transect, TranLen) %>% 
    group_by(AdministrationUnit_Name, Purpose, Type, Macroplot, MonStatus) %>%
    tidyr::uncount(weights = NumTran, .id = "Transect") %>%
    mutate(Transect = suppressWarnings(as.numeric(Transect))) %>% 
    dplyr::rename(ThousHrTranLen = TranLen) %>% 
    unique()
  
  
  # ---- Step 5C: Bring zeros back in for missing decay classes ---- #
  fuel_by_transect <- all_transects %>%
    left_join(loads_per_transect,
              by = c("AdministrationUnit_Name", "Purpose", "Type", "Macroplot", "MonStatus", "Transect", "ThousHrTranLen")) %>%
    mutate(
      ThousHrSound             = replace_na(ThousHrSound, 0),
      ThousHrRott              = replace_na(ThousHrRott, 0),
      ThousHr                  = replace_na(ThousHr, 0),
      ThousHrSound_FuelLoad    = replace_na(ThousHrSound_FuelLoad, 0),
      ThousHrRott_FuelLoad     = replace_na(ThousHrRott_FuelLoad, 0),
      ThousHr_FuelLoad         = replace_na(ThousHr_FuelLoad, 0)
    ) %>% 
    unique()


  return(fuel_by_transect)
}
```

## Fuels Duff Litter

```{r calculate fuel loads, include=FALSE}
# -------------------------------------- #  
# ---- Litter and Duff Measurements ---- #
# -------------------------------------- #

# ---- Function to calculate litter and duff fuel loads ---- #
calculate_litterduff <- function(fuels_df) {
 
  
  # ---- Step 1: Ensure Transect is numeric BEFORE calculations ---- #
  
  fuels_df <- fuels_df %>% 
    mutate(
      SampleEventDate = ymd(SampleEventDate),
      Transect = suppressWarnings(as.numeric(Transect))
      )
  
  # ================================ #
  # ==== Bulk density constants ==== #
  # ================================ #

  #litter_bd <- 2.75 * 1.815 # FFI default bulk density for litter (2.75)
  #duff_bd   <- 5.5  * 1.815 # FFI default bulk density for duff (5.5)
  
  # ---- Step 2: Transect-level averages ---- #
  transect_means <- fuels_df %>%
    group_by(AdministrationUnit_Name, Purpose, Type, Macroplot, MonStatus, Transect, NumTran) %>% 
    dplyr::summarise(
      Tran_LittDep = mean(LittDep, na.rm = TRUE),
      Tran_DuffDep = mean(DuffDep, na.rm = TRUE),
      .groups = "drop"
    ) %>%
    mutate(
      Tran_LittDep = ifelse(is.nan(Tran_LittDep), 0, Tran_LittDep),
      Tran_DuffDep = ifelse(is.nan(Tran_DuffDep), 0, Tran_DuffDep)
    ) %>% 
    filter(Transect <= NumTran) %>%   # keep only valid transects
    mutate(
      litter_bd = 2.75 * 1.815, # FFI default bulk density for litter (2.75)
      duff_bd   = 5.5  * 1.815, # FFI default bulk density for duff (5.5)
      Tran_Litt_FuelLoad = Tran_LittDep * litter_bd,
      Tran_Duff_FuelLoad   = Tran_DuffDep * duff_bd,
      Tran_LittDuff_FuelLoad  = Tran_Litt_FuelLoad + Tran_Duff_FuelLoad
    )
  
  # ---- Step 3: Plot-level averages ---- #
  plot_means <- transect_means %>%
    group_by(AdministrationUnit_Name, Purpose, Type, Macroplot, MonStatus) %>%
    dplyr::summarise(
      Transect = Transect,
      
      # ---- KEEP TRANSECT FUEL VALUES ---- #
      Tran_LittDep = Tran_LittDep,
      Tran_DuffDep = Tran_DuffDep,
      Tran_Litt_FuelLoad = Tran_Litt_FuelLoad,
      Tran_Duff_FuelLoad   = Tran_Duff_FuelLoad,
      Tran_LittDuff_FuelLoad  = Tran_LittDuff_FuelLoad,
      
      # ---- plot-level depth ---- #
      Avg_LittDep = mean(Tran_LittDep, na.rm = TRUE),
      Avg_DuffDep = mean(Tran_DuffDep, na.rm = TRUE),
  
      # ---- plot-level fuels ---- #
      Avg_Litt_FuelLoad = mean(Tran_Litt_FuelLoad, na.rm = TRUE),
      Avg_Duff_FuelLoad   = mean(Tran_Duff_FuelLoad, na.rm = TRUE),
      Avg_LittDuff_FuelLoad  = mean(Tran_LittDuff_FuelLoad, na.rm = TRUE),
  
      .groups = "drop"
  ) %>% 
    mutate(Avg_LittDep = na_if(Avg_LittDep, NaN),
           Avg_DuffDep = na_if(Avg_DuffDep, NaN),
           Avg_Litt_FuelLoad = na_if(Avg_Litt_FuelLoad, NaN),
           Avg_Duff_FuelLoad = na_if(Avg_Duff_FuelLoad, NaN),
           Avg_LittDuff_FuelLoad = na_if(Avg_LittDuff_FuelLoad, NaN)
           )
  
  return(plot_means)
}
```

## Fuels Fine

```{r calculate fuel loads, include=FALSE}
# ------------------------------------- #
# ---- Fine Fuels (1,10,100-Hours) ---- #
# ------------------------------------- #

# ---- Function to calculate 1-100-hr fuels for any park dataset ---- #
calculate_fine_fuels <- function(fuels_df) {
  
  # ---- Step 1: Ensure Date is proper datetime format ---- #
  fuels_df <- fuels_df %>%
    mutate(
      SampleEventDate = ymd(SampleEventDate)
    )
  
  # ---- Step 2: Compute per-transect fuel load ---- #
  transect_level <- fuels_df %>%
    mutate(
      d2_1hr = 0.0151,
      d2_10hr = 0.289, 
      d2_100hr = 2.76, 
      s_1hr_10hr = 0.48,
      s_100hr = 0.40,
      a = 1.13,
      c = sqrt(1 + (Slope / 100)^2),
      OneHr_FuelLoad = (11.64 * OneHr * d2_1hr   * s_1hr_10hr * a * c) / OneHrTranLen,
      TenHr_FuelLoad = (11.64 * TenHr * d2_10hr  * s_1hr_10hr * a * c) / TenHrTranLen,
      HunHr_FuelLoad = (11.64 * HunHr * d2_100hr * s_100hr    * a * c) / HunHrTranLen,
      Fine_FuelLoad = OneHr_FuelLoad + TenHr_FuelLoad + HunHr_FuelLoad
    )

  # ---- Step 3: KEEP TRANSECT-LEVEL DATA (do NOT summarise here) ---- #
  plot_level_fine <- transect_level %>%
    dplyr::mutate(
      Transect_ID = row_number()  # keeps unique transect within plot
    )
}
```

## Combine Fuels

```{r calculate fuel loads, include=FALSE}
Fuels1000_all <- Fuels1000 %>% 
  select(!c(MacroPlot.UV1, MacroPlot.UV2, MacroPlot.UV3, MacroPlot.UV4, MacroPlot.UV5, MacroPlot.UV6, MacroPlot.UV7, MacroPlot.UV8, Status.Prefix, Status.Base, Status.Suffix, MonStatusOrd, SampleEventDate_Year, FieldTeam, EntryTeam, UV1Desc, UV2Desc, UV2Desc, UV3Desc, SaComment, Visited, Index)) %>% 
  mutate(SampleEventDate = ymd(SampleEventDate))

Fuels1000_sum <- calculate_coarse_fuels(Fuels1000_all)
FuelsDuffLitt_sum <- calculate_litterduff(FuelsDuffLitt)
FuelsFine_sum <- calculate_fine_fuels(FuelsFine)
```

```{r combine dataframes, include=FALSE}
# ============================================================= #
# ==== Join 1-100-hr, litter-duff, and 1,000-hr dataframes ==== #
# ============================================================= #

Fuels <- FuelsFine_sum %>%
  dplyr::full_join(FuelsDuffLitt_sum, by = c("AdministrationUnit_Name", "Purpose", "Type", "Macroplot", "MonStatus", "Transect")) %>% 
  dplyr::full_join(Fuels1000_sum, by = c("AdministrationUnit_Name", "Purpose", "Type", "Macroplot", "MonStatus", "Transect")) %>% 
  relocate(ThousHrTranLen, .after = HunHrTranLen) %>% 
  relocate(ThousHrSound, .after = HunHr) %>% 
  relocate(ThousHrRott, .after = ThousHrSound) %>% 
  relocate(ThousHr, .after = ThousHrRott)
```

```{r}
write.csv(Fuels, paste0(path_save, "Data_Surface Fuels.csv"), quote = FALSE, row.names = FALSE)
```

# Trees

## Poles & Overstory

```{r}
# ------------------------------------- #
# ------           Trees         ------ #
# ------------------------------------- #
#trees_df <- Trees
# ---- Function to calculate tree density for any park dataset ---- #
calculate_trees_dens <- function(trees_df) {
  
  # ---- Step 1: Ensure Date is proper datetime format ---- #
  trees_df <- trees_df %>%
    mutate(
      SampleEventDate = ymd(SampleEventDate)
    )
  
  # ---- Step 2: Compute per-transect fuel load ---- #
  plot_level <- trees_df %>%
    mutate(
      Area = ifelse(SubFrac == 0.25, 250, 1000),
      Hectar = Area / 10000,
      Acre = Hectar * 2.47105,
      SizeCl = if_else(DBH < 15.0, "Pole", "Overstory"),
    )

      
  # ---- Step 3: Plot-level summaries ---- #
  ## ------------ Pole-Sized ------------ ##
  plot_level_pole <- plot_level %>% 
    filter(SizeCl == "Pole") %>% 
    group_by(AdministrationUnit_Name, Purpose, Type, Macroplot, MonStatus, Genus, Status) %>% 
    dplyr::summarise(
      Avg_Pole_Ht_m = round(mean(Ht), 1),
      Avg_Pole_Ht_ft = round((Avg_Pole_Ht_m * 3.28084), 1),
      Pole_Count = n_distinct(TagNo),
      Pole_Species = paste(na.omit(unique(Species.Symbol)), collapse = "; "),
      Pole_Dens_ha = round(Pole_Count / Hectar),
      Pole_Dens_ac = round(Pole_Count / Acre),
      .groups = "drop"
    ) %>% 
    unique()
  ## ------------- Overstory ------------- ##
  plot_level_overstory <- plot_level %>% 
    filter(SizeCl == "Overstory") %>% 
    group_by(AdministrationUnit_Name, Purpose, Type, Macroplot, MonStatus, Genus, Status) %>% 
    dplyr::summarise(
      Overstory_Count = n_distinct(TagNo),
      Overstory_Species = paste(na.omit(unique(Species.Symbol)), collapse = "; "),
      Overstory_Dens_ha = round(Overstory_Count / Hectar),
      Overstory_Dens_ac = round(Overstory_Count / Acre),
      .groups = "drop"
    ) %>% 
    unique()

  
  # ---- Step 4: COMBINE ---- #
  plot_level_merge <- plot_level %>% 
    select(AdministrationUnit_Name, Purpose, Type, Macroplot, MonStatus, Genus, Status) %>% 
    unique()
  
  plot_level_sum <- plot_level_merge %>% 
    full_join(plot_level_pole, by = c("AdministrationUnit_Name", "Purpose", "Type", "Macroplot", "MonStatus", "Genus", "Status")) %>% 
    full_join(plot_level_overstory, by = c("AdministrationUnit_Name", "Purpose", "Type", "Macroplot", "MonStatus", "Genus", "Status")) %>% 
    mutate(
      Pole_Count     = replace_na(Pole_Count, 0),
      Pole_Dens_ha   = replace_na(Pole_Dens_ha, 0),
      Pole_Dens_ac   = replace_na(Pole_Dens_ac, 0),
      Overstory_Count      = replace_na(Overstory_Count, 0),
      Overstory_Dens_ha    = replace_na(Overstory_Dens_ha, 0),
      Overstory_Dens_ac    = replace_na(Overstory_Dens_ac, 0)
    )
}
```

## Seedlings

```{r}
# ------------------------------------- #
# ----           Seedlings         ---- #
# ------------------------------------- #
#seedlings_df <- Seedlings
# ---- Function to calculate seedling density for any park dataset ---- #
calculate_seedlings_dens <- function(seedlings_df) {
  
  # ---- Step 1: Ensure Date is proper datetime format ---- #
  seedlings_df <- seedlings_df %>%
    mutate(
      SampleEventDate = ymd(SampleEventDate)
    )
  
  # ---- Step 2: Compute per-transect fuel load ---- #
  plot_level <- seedlings_df %>%
    mutate(
      SizeCl = if_else(Height <= 4, "Seedling (< 1m ht)", "Sapling (> 1m ht)"),
      Area = QuadLen * QuadWid,
      Hectar = Area / 10000,
      Acre = Hectar * 2.47105
    ) %>% 
    relocate(Count, .after = Acre) %>% 
    relocate(Genus, .after = Acre) %>% 
    relocate(SizeCl, .after = Acre)

      
  # ---- Step 3: Plot-level summaries ---- #
  ## ------------- Seedlings ------------ ##
  plot_level_seedling <- plot_level %>% 
    filter(SizeCl == "Seedling (< 1m ht)") %>% 
    group_by(AdministrationUnit_Name, Purpose, Type, Macroplot, MonStatus, Genus, Status) %>% 
    dplyr::summarise(
      Seedling_Count = sum(Count),
      Seedling_Species = paste(na.omit(unique(Species.Symbol)), collapse = "; "),
      Seedling_Dens_ha = round(Seedling_Count / Hectar),
      Seedling_Dens_ac = round(Seedling_Count / Acre),
      .groups = "drop"
    ) %>% 
    unique()
  ## ------------- Saplings ------------- ##
  plot_level_sapling <- plot_level %>% 
    filter(SizeCl == "Sapling (> 1m ht)") %>% 
    group_by(AdministrationUnit_Name, Purpose, Type, Macroplot, MonStatus, Genus, Status) %>% 
    dplyr::summarise(
      Sapling_Count = sum(Count),
      Sapling_Species = paste(na.omit(unique(Species.Symbol)), collapse = "; "),
      Sapling_Dens_ha = round(Sapling_Count / Hectar),
      Sapling_Dens_ac = round(Sapling_Count / Acre),
      .groups = "drop"
    ) %>% 
    unique()

  
  # ---- Step 4: COMBINE ---- #
  plot_level_merge <- plot_level %>% 
    select(AdministrationUnit_Name, Purpose, Type, Macroplot, MonStatus, Genus, Status) %>% 
    unique()
  
  plot_level_sum <- plot_level_merge %>% 
    full_join(plot_level_seedling, by = c("AdministrationUnit_Name", "Purpose", "Type", "Macroplot", "MonStatus", "Genus", "Status")) %>% 
    full_join(plot_level_sapling, by = c("AdministrationUnit_Name", "Purpose", "Type", "Macroplot", "MonStatus", "Genus", "Status")) %>% 
    mutate(
      Seedling_Count     = replace_na(Seedling_Count, 0),
      Seedling_Dens_ha   = replace_na(Seedling_Dens_ha, 0),
      Seedling_Dens_ac   = replace_na(Seedling_Dens_ac, 0),
      Sapling_Count      = replace_na(Sapling_Count, 0),
      Sapling_Dens_ha    = replace_na(Sapling_Dens_ha, 0),
      Sapling_Dens_ac    = replace_na(Sapling_Dens_ac, 0)
    )
}
```

## Combine Trees

```{r}
Trees_meta <- Trees %>% 
  select(1:20, Genus, Status) %>% 
  unique()

Trees_sum <- calculate_trees_dens(Trees)
Seedlings_sum <- calculate_seedlings_dens(Seedlings)
```

```{r}
Trees_Seedlings <- Trees_meta %>% 
  dplyr::full_join(Seedlings_sum, by = c("AdministrationUnit_Name", "Purpose", "Type", "Macroplot", "MonStatus", "Genus", "Status")) %>% 
  dplyr::full_join(Trees_sum, by = c("AdministrationUnit_Name", "Purpose", "Type", "Macroplot", "MonStatus", "Genus", "Status")) %>% 
  mutate(
      Seedling_Count     = replace_na(Seedling_Count, 0),
      Seedling_Dens_ha   = replace_na(Seedling_Dens_ha, 0),
      Seedling_Dens_ac   = replace_na(Seedling_Dens_ac, 0),
      Sapling_Count      = replace_na(Sapling_Count, 0),
      Sapling_Dens_ha    = replace_na(Sapling_Dens_ha, 0),
      Sapling_Dens_ac    = replace_na(Sapling_Dens_ac, 0)
    ) %>% 
  unique()
```

```{r}
write.csv(Trees_Seedlings, paste0(path_save, "Data_Trees-Seedlings.csv"), quote = FALSE, row.names = FALSE)
```

# Cover

## Herbs Points

```{r}
# ------------------------------------- #
# ------           Herbs         ------ #
# ------------------------------------- #
cover_df <- HerbsPoints
# ---- Function to calculate herbaceous cover for any park dataset ---- #
calculate_Points_cover <- function(cover_df) {
  
  # ---- Step 1: Ensure Date is proper datetime format ---- #
  cover_df <- cover_df %>%
    mutate(
      SampleEventDate = ymd(SampleEventDate)
    )
  
  # ---- Step 2: Add useful columns ---- #
  plot_level <- cover_df %>%
    mutate(
      Nativity = ifelse(Native.Species == "True", "Native",
                           ifelse(Invasive.Species == "True", "Invasive", "Unknown"))
      )

      
  # ---- Step 3: Plot-level summaries ---- #
  plot_level <- plot_level %>% 
    group_by(AdministrationUnit_Name, Purpose, Type, Macroplot, MonStatus, Preferred_Lifeform, Genus, Species.Symbol, Nativity) %>% 
    dplyr::summarise(
      NumTran = NumTran,
      NumPtsTran = NumPtsTran,
      #Species = paste(na.omit(unique(Species.Symbol)), collapse = "; "),
      Avg_Ht_m = round(mean(Height), 1),
      Avg_Ht_ft = round((Avg_Ht_m * 3.28084), 1),
      Hits = n(),
      PctCover = round(((Hits / (NumPtsTran * NumTran)) * 100), 1),
      .groups = "drop",
      ) %>% 
    unique()
}
```

## Herbs Species Comp

```{r}
# ------------------------------------- #
# ---- Cover Species Composition   ---- #
# ------------------------------------- #
#cover_df <- HerbsSpComp
# ---- Function to calculate 1-100-hr fuels for any park dataset ---- #
calculate_SpComp_cover <- function(cover_df) {
  
  # ---- Step 1: Ensure Date is proper datetime format ---- #
  cover_df <- cover_df %>%
    mutate(
      SampleEventDate = ymd(SampleEventDate)
    )
  
  # ---- Step 3: Add useful columns ---- #
  plot_level <- cover_df %>%
    mutate(
      Nativity = ifelse(Native.Species == "True", "Native",
                           ifelse(Invasive.Species == "True", "Invasive", "Unknown"))
      ) %>% 
    group_by(AdministrationUnit_Name, Macroplot, MonStatus, SampleEventDate_Year) %>%
    dplyr::mutate(
      n_species = n_distinct(Species.Symbol),
      .groups = "drop"
    )
}
```

### Combine Herbs

```{r}
HerbsPoints_sum <- calculate_Points_cover(HerbsPoints)
HerbsSpComp_sum <- calculate_SpComp_cover(HerbsSpComp)
```

```{r}
Cover <- HerbsSpComp_sum %>% 
  dplyr::full_join(HerbsPoints_sum, by = c("AdministrationUnit_Name", "Purpose", "Type", "Macroplot", "MonStatus", "Preferred_Lifeform", "Genus", "Species.Symbol", "Nativity")) %>% 
  mutate(PctCover = ifelse(is.na(PctCover), 0.01, PctCover))
```

```{r}
write.csv(Cover, paste0(path_save, "Data_Cover.csv"), quote = FALSE, row.names = FALSE)
```
